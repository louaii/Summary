Infrastructure(البنية التحتية): hardware and software components, facilities, data centers, servers, networking hardware, desktop computers and enterprise application software solutions

IaC(Infrastructure as a Code): is defined as using software code for resource provisining in data center and cloud ennvironments instead of hardware settings or configuration tools, with benefits of automation and remote provisioning. IaC involves managing data centers through code modules rather than interactive configuration toolsor physical hardware tools. In straight forward terms, IaC means managing your IT Infrastructure with line of code, the code becomes part of the project and is stored insidde the vcs(version control system)


                                                                                 manages =====> Infra Cloud
                                                                                   //
                                                                                  //
dev ===write====> Infra Code========Push=======Pull=========Automation API/Server
                      ||                                                          \\
                      ||                                                           \\
                      ||                                                         manages =====> Infra premises
                     \  /
                      VCS 


Iac works through templates, the config files are created upon the infrastructure specs

.The 4 types of IaC:
_Scripting: is a very direct form of IaC usually used for simple or on-off tasks(not advised for complex one)
_Config management tools: implement automation by installing and configuring servers designed for complex tasks as they are specialized tools built to manage software
_Provisioning tools: implement automation by creating infrastructure used by devs to create infrastructure components
_Containers and templating tools: formulate templates and images pre-loaded with all the libraries and components required to run an application. Data distributed with these tools are easy to manage and have a lower overhead compared to running an entire server

.Two Approaches of automating infrastructure:
_Declarative(function): You define the desired state of the final solution(No guide or step by step)
_Imperative(procedure): You define the steps to execute in order to reach the desired solution(step by step as dockerfile)

.Mutable vs Immutable infrastructure:
_Mutable: can be changed to fit business needs. You can easily introduce updates to the existing version, apply patches and scale(puppet, chef, Ansible)
_Immutable: cannot be changed once deployed. If you want to make alterations to it, you have ti replace it with a new version(Kubernetes, Docker, Terraform)

.Agent vs Agentless: 
_Agent-based: tools as Puppet require the user to install a piece of software on each device that needs to be managed, called an agent each communicates over encrypted communications methods to a controlling 'master' devic, which stores the desired configs of the machines it manages.
_Agentless-based: tools such as Ansible do not require agents to be installed to manage machines and communicate via protocols such as SSH, this approach is great when quick and easy deployments needs to be made. The problem is that there is no way of reporting back on a machine's current state or enforcing a desired state to make sure it is compliant

Benefits of IaC:
Efficiency, versioning and tracking, speed, collaboration, eliminate config drift(exactly what needed without downtime or collisions), stable, scalable, disaster recovery

IaC tools: Terraform, Puppet, AWS cloud foundation, Ansible, Chef 

What is Terraform?
------------------

Terraform is an IaC tool that lets you define both cloud and on premises resources in human readable config files that can be version reuse and share to automate infra tasks. It is an open source cloud agnostic(run seamlessly across any cloud provider) provisioning tool developed by HarshCorp written in GO lang in 28/7/14


			Practitioner				Community
			     ||                                    ||
                             ||                                    ||
                             ||                                    ||
                             ||                                   \  /
                             ||                                    \/
                             ||                               Public model
                             ||                                 Regisrty
                             ||                                    ||
                            \  /                                  //
                             \/     /                            //
                        IaC(config)/=============================
                             ||    \
                             ||     \
                             ||
                             ||
                            \  /
                             \/
                            Plan
                             ||
                             ||
                             ||
                            \  /
                             \/
                            Apply
                             ||
                             ||
                             ||
                            \  /
                             \/
                           Cloud
                           /    \
                          /      \
                         /        \
                        /          \
                       PCs      Servers


Terraform's HCL(HarshiCorp Config Language) allows a dev to learn one language to work with multiple cloud offerings and on premises providers rather than having to learn a new service and language for each

HCL is a declarative language, focusing on the end state as opposed to a procedural language, where all commands are executed in the order written
Declarative language focuses on specifiying the desired end-state, letting the IaC tool handle the implementation details

Primary user                   Resource Meta                Resource                 Core
  interface                         Data                     Graph                Application
---------------------------------------------------------------------------------------------------
HarshiCorp Config                  Files                      API                Authentication
   Language                        State                 Communication                API
                                                                                 Calls Resource
                                                                                     Mapping
                                                                                    Providers
                                                                                 (AWS, Azure, VM,
										    Kubernetes)


Terraform Benefits:
.Manage any infra on multiple cloud
.Track infra through state file or source of truth
.Automate Changes
.Human-readable config lang
.Helps write infra code quickly
.Commit configs through version control to safely collaborate on infra

The Core Terraform workflow consists three stages:

.Write: Define infra and resource in config files which may be across multiple cloud providers and services

						Terraform Project
                                                        ||
                                                       /  \
                                                      /    \
                                                     /      \
                                                    /        \ 
                                                   /          \
                                               Config        State

.Plan: Review the changes Terraform will make to the infra, Terraform creates an execution plan describing the infra will create, update, or destroy based on the existing infra and your config($terraform plan)

.Apply: Terraform provisions your infra and updates the files state on approval, Terraform performs the proposed operations in the correct order, respecting any resources dependencies




How to deploy infra with Terraform
.Scope: Identify the infra for the project
.Author: Write the config for infra
.Initialize: Install the plugins Terraform needs to manage the infra
.Plan: Preview the changes Terraform will make to match the config
.Apply: Make the planned changes


What is provisioning?
Provisioning is the process of setting up IT infrastructure. It can also refer to the steps required to manage access to data and resources, make them available to users and systems. Once something has been provisioned, the next step is config



Infrastructure Provisioning vs Configuration Management:
--------------------------------------------------------


Infra provisioning is the process of provisioning IT infrastructure resources like VM servers, Storage, network, cloud managed services, etc...
Terraform, Pulumi and cloud formation are popular examples of infrastructure provisioning tools. Its primary purpose is to keep the infrastructure in its desired state and reproduce or update it whenever needed

Configuration management is the process of configuring provisioned infra resources. As example configuring a server with required apps or configuring a firewall device. The primary purpose of config management tools is to configure the server. Meaning if you want to automate the installation and configuration of an application(nginx) in a server we use a tool like Ansible and Chef. It ensures all the servers are running in the same config mentioned in the ansible playbook or chef cook book

Infra Provisioning(Terraform) is responsible for providing the network and servers 
Config management(Ansible) configures apps inside servers provisioned by Terraform

!Note: Infra provisioning and config management are not mutually exclusive Most config management tools can do some degree of provisioning and vice versa



Infra Provisioning														Config Management
      ||															       ||
      ||                                                                                                                               ||
      ||															       ||
      ||                                                                                                                               ||
     \  /                                                                                                                             \  /
      \/                                                                                                                               \/
Creates Infra Components                                                                                                 Configures provisioned servers
      ||															       ||
      ||                                                                                                                               ||
      ||															       ||
      ||                                                                                                                               ||
     \  /                                                                                                                             \  /
      \/                                                                                                                               \/
   Terraform                                                                                                                         Ansible
	 \\                                                                                                                           //
          \\                                                                                                                         //
           \\                                                                                                                       //
            \\                                                                                                                     //
             \\                                                                                                                   //
           Provisioning servers/VPC=======================================AWS=================================Install and config apps on provisioned server
                                                                    Server/VPC network


Configuration Management:



Get server details
from inventory(ip/ssh_key)
          /\
         /  \
          ||
          ||
          || 
          ||
          ||
     Puppet, chef                                                                                                                       \
  saltstack, Ansible ============================================Connect through ssh and execute list===================================  Server
                                                                     of tasks module cook/play book                                     /


Terraform Summary:
.HCL language
.Declarative
.Infra Provisioning
.Immutable
.Agentless
.Any cloud provider

